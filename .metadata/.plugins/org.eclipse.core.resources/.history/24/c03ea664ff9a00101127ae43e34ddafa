/*
 * exti.c
 *
 *  Created on: Sep 26, 2025
 *      Author: garrettfalast
 */

#include "exti.h"

#define GPIOCEN			(1U<<2)
#define SYSCFGEN		(1U<<14)


void pc13_exti_init(void) {
	// disable global interrupt
	__disable_irq();

	// enable clock access for GPIOC
	RCC->AHB1ENR |= GPIOCEN;

	// enable clock access to SYSCFG
	RCC->APB2ENR |= SYSCFGEN;

	// set PC13 as input pin
	GPIOC->MODER &= ~(1U<<26);
	GPIOC->MODER &= ~(1U<<27);

	// select PORTC for EXTI13
	SYSCFG->EXTICR[3] |= (1U<<5);

	// unmask EXTI13
	EXTI->IMR |= (1U<13);

	// select falling edge trigger

	// enable EXTI line in NVIC

	// re-enable global interrupt
	__enable_irq();

}

